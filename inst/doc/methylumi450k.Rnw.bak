% -*- mode: noweb; noweb-default-code-mode: R-mode; -*-
%\VignetteIndexEntry{Working with Illumina 450k Arrays using methylumi}
%\VignetteDepends{IlluminaHumanMethylation450k.db}
%\VignetteDepends{TCGAMethylation450k}
%\VignettePackage{methylumi}
\documentclass{article}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage[authoryear,round]{natbib}
\newcommand{\Rfunction}[1]{{\texttt{#1}}}
\newcommand{\Robject}[1]{{\texttt{#1}}}
\newcommand{\Rpackage}[1]{{\textit{#1}}}
\newcommand{\Rclass}[1]{{\textit{#1}}}
\newcommand{\Rmethod}[1]{{\textit{#1}}}

\SweaveOpts{keep.source=TRUE,cache=TRUE}
\begin{document}
\setkeys{Gin}{width=0.8\textwidth} 
\author{Tim Triche, Jr. & Sean Davis}
\title{Working with Illumina 450k Arrays using methylumi}
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Creating a MethyLumiSet object from IDATs}

<<setup,eval=true,hide=true,echo=false>>=
options('width'=55)
@ 

<<load libraries and data for analysis, eval=T>>=
library('methylumi')
library('IlluminaHumanMethylation450k.db')
require('TCGAMethylation450k')
barcodes <- c('6005486014_R04C02',
              '6005486023_R05C01')
lumi450k <- methylumIDAT(barcodes,idatPath=system.file('extdata/idat',package='TCGAMethylation450k')) # no normalization done
sampleNames(lumi450k) <- c('TCGA1','TCGA2')
show(lumi450k)
@

\clearpage

\section{Negative and normalization controls}
Plot the negative and normalization controls:

\begin{figure}[h!]
\centering
<<controls, fig=true, width=6.5, height=8, quiet=T, echo=T, cache=FALSE>>=
library(ggplot2)
p <- qc.probe.plot(lumi450k, by.type=TRUE)
print(p)
@
\caption{Some of the controls on the 450k chip}
\label{fig:controlplot}
\end{figure}            

\clearpage
\section{sessionInfo}
<<results=tex,echo=false>>=
#save(lumi450k, file="lumi450k.rda")
toLatex(sessionInfo())
@ 

\end{document}

